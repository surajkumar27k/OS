<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Adaptive Hybrid Scheduler — OS Simulation</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- WebGL canvas for shader background -->
  <canvas id="gl-bg-canvas" aria-hidden="true"></canvas>
  <!-- FIX: Include the overlay div for the animated gradient effect -->
  <div class="gl-bg-overlay" aria-hidden="true"></div> 

  <header class="site-header">
    <div class="container header-inner">
      <div class="header-left">
        <h1 class="project-title">Adaptive Hybrid Scheduler</h1>
        <p class="project-tagline">Hybrid (RMS + EDF) scheduler with Energy-Aware DVFS simulation for real-time systems</p>
      </div>

      <div class="header-right">
        <nav class="top-nav">
          <a href="https://github.com/surajkumar27k/OS" target="_blank" rel="noopener">Repository</a>
          <a href="#features">Features</a>
          <a href="#demo">Demo</a>
          <a href="#run">Run</a>
        </nav>

        <button id="theme-toggle" class="theme-toggle" aria-pressed="false" title="Toggle dark/light theme">
          <span id="theme-icon">🌙</span>
          <span class="visually-hidden">Toggle theme</span>
        </button>

        <button id="bg-toggle" class="theme-toggle" aria-pressed="true" title="Toggle background animations">
          <span id="bg-icon">✨</span>
          <span class="visually-hidden">Toggle background</span>
        </button>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="hero">
      <div class="hero-left">
        <h2>Design and Simulation of an Adaptive Hybrid Scheduling Framework</h2>
        <p class="lead">Combine RMS for critical periodic tasks with EDF for dynamic tasks and add an energy-aware DVFS module to reduce power while meeting deadlines.</p>
        <div class="cta">
          <a class="btn" href="#demo">Open Demo</a>
          <a class="btn ghost" href="README.md" target="_blank">Read README</a>
        </div>
      </div>
      <div class="hero-right">
        <div class="card">
          <h3>Quick Stats</h3>
          <ul>
            <li>Languages: JavaScript, CSS, HTML</li>
            <li>Simulation: Browser demo (interactive) + recommended Python/C++ backends</li>
            <li>Visualizations: Interactive Gantt chart & metrics</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- DEMO SECTION: Must contain all IDs used by script.js -->
    <section id="demo" class="demo">
        <div class="dashboard">
            <h3 class="title">Scheduler Simulation Controls</h3>

            <!-- Row 1: Scheduler and Time -->
            <div class="controls card demo-controls">
                <div class="row">
                    <!-- Scheduler Selector -->
                    <div>
                        <label for="scheduler-select">Scheduler:</label>
                        <select id="scheduler-select">
                            <option value="hybrid">Adaptive Hybrid (RMS/EDF)</option>
                            <option value="energy-hybrid">Energy-Aware Hybrid (DVFS)</option>
                            <option value="rms">Rate Monotonic (RMS)</option>
                            <option value="edf">Earliest Deadline First (EDF)</option>
                        </select>
                    </div>

                    <!-- Total Time Input -->
                    <div>
                        <label for="total-time">Total Time (Ticks):</label>
                        <input type="number" id="total-time" value="200" min="50" max="1000">
                    </div>

                    <!-- Laxity Threshold (for DVFS) -->
                    <div>
                        <label for="laxity-threshold">Laxity Threshold:</label>
                        <input type="number" id="laxity-threshold" value="20" min="5" max="100">
                    </div>
                </div>
            </div>

            <!-- Row 2: Actions -->
            <div class="cta sched-btns">
                <button id="load-sample" class="sched-btn">Load Sample Tasks</button>
                <button id="run" class="btn">Run Simulation</button>
                
                <!-- File Input for Upload -->
                <input type="file" id="file-input" style="display:none;" accept=".json, .csv">
                <button id="upload" class="sched-btn ghost">Upload Taskset (.json)</button>
            </div>

            <!-- Task Display Area (Sample JSON Pre) -->
            <details class="card" style="text-align: left; margin-top: 20px;">
                <summary>Current Task Set (Edit JSON directly here or load/upload)</summary>
                <pre id="sample-json" class="sample-json"></pre>
            </details>
        </div>

        <!-- Gantt Chart Output Container -->
        <div class="card" style="margin-top: 24px;">
            <h3>Gantt Chart Timeline</h3>
            <div id="gantt-container" class="gantt-container">
                <div class="gantt-placeholder">Load tasks and click Run Simulation to see the timeline.</div>
            </div>
        </div>

        <!-- Metrics Output Container -->
        <div id="metrics" class="card" style="display:none; margin-top: 16px;">
            <!-- Metrics will be inserted here by script.js -->
        </div>
    </section>
    <!-- END DEMO SECTION -->

  </main>

  <footer class="site-footer">
    <div class="container">
      <p>© 2025 P S SURAJ KUMAR — Adaptive Hybrid Scheduler</p>
      <p><a href="https://github.com/surajkumar27k/OS" target="_blank">GitHub Repository</a></p>
    </div>
  </footer>

  <!-- WebGL shader background controller -->
  <script src="background-gl.js"></script>

  <!-- Theme + UI toggles (merge with your existing theme code if needed) -->
  <script>
  (function() {
    const root = document.documentElement;
    const toggle = document.getElementById('theme-toggle');
    const icon = document.getElementById('theme-icon');
    const KEY = 'site-theme';

    function setTheme(theme) {
      if (theme === 'dark') {
        root.classList.add('dark');
        toggle.setAttribute('aria-pressed', 'true');
        icon.textContent = '🌙';
      } else {
        root.classList.remove('dark');
        toggle.setAttribute('aria-pressed', 'false');
        icon.textContent = '☀️';
      }
      if (window.ShaderBG && window.ShaderBG.setTheme) window.ShaderBG.setTheme(theme);
    }

    const saved = localStorage.getItem(KEY);
    if (saved === 'dark' || saved === 'light') {
      setTheme(saved);
    } else {
      const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      setTheme(prefersDark ? 'dark' : 'light');
    }

    toggle.addEventListener('click', () => {
      const isDark = root.classList.contains('dark');
      const newTheme = isDark ? 'light' : 'dark';
      setTheme(newTheme);
      localStorage.setItem(KEY, newTheme);
    });

    // background toggle
    const bgToggle = document.getElementById('bg-toggle');
    const bgIcon = document.getElementById('bg-icon');
    let bgOn = true;
    bgToggle.addEventListener('click', () => {
      bgOn = !bgOn;
      bgToggle.setAttribute('aria-pressed', String(bgOn));
      bgIcon.textContent = bgOn ? '✨' : '⛔';
      if (window.ShaderBG) window.ShaderBG.setEnabled(bgOn);
    });
  })();
  </script>

  <!-- Your existing simulator script should come after the background so UI overlays properly -->
  <script src="script.js"></script>
</body>
</html>
